<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calories & Weight</title>

  <style>
    :root{
      --color-bg: #ffffff;
      --color-surface: #ffffff;
      --color-surface-2: #f7f9fc;
      --color-border-subtle: rgba(15, 23, 42, 0.10);
      --color-text-primary: #0f172a;
      --color-text-secondary: #64748b;
      --color-point: #2563eb;

      --radius-lg: 20px;
      --radius-md: 14px;
      --shadow-sm: 0 10px 30px rgba(15, 23, 42, 0.06);
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    * { box-sizing: border-box; }
    body{
      margin: 0;
      font-family: var(--font);
      color: var(--color-text-primary);
      background: var(--color-bg);
    }

    .wrap{
      max-width: 1180px;
      margin: 0 auto;
      padding: 28px 22px 40px;
    }

    h1{
      margin: 0 0 8px;
      font-size: 40px;
      letter-spacing: -0.02em;
    }
    .sub{
      margin: 0 0 26px;
      color: var(--color-text-secondary);
      font-size: 16px;
    }

    .row{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
    }

    /* Tabs */
    .tabs{
      display: inline-flex;
      padding: 6px;
      border-radius: 999px;
      border: 1px solid var(--color-border-subtle);
      background: var(--color-surface);
      box-shadow: var(--shadow-sm);
      gap: 6px;
    }
    .tab{
      appearance: none;
      border: 0;
      background: transparent;
      padding: 10px 14px;
      border-radius: 999px;
      color: var(--color-text-secondary);
      font-weight: 600;
      cursor: pointer;
      font-size: 14px;
    }
    .tab--active{
      background: var(--color-surface-2);
      color: var(--color-text-primary);
      border: 1px solid var(--color-border-subtle);
    }

    /* Filters */
    .filters{
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }
    .field{
      display: grid;
      gap: 6px;
      font-size: 12px;
      color: var(--color-text-secondary);
    }
    .ctrl{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--color-border-subtle);
      background: var(--color-surface);
      min-height: 42px;
    }
    .ctrl input{
      border: 0;
      outline: 0;
      font: inherit;
      width: 120px;
      color: var(--color-text-primary);
      background: transparent;
    }
    .ctrl select{
      border: 0;
      outline: 0;
      font: inherit;
      color: var(--color-text-primary);
      background: transparent;
      cursor: pointer;
    }
    .dash{ color: var(--color-text-secondary); }

    /* Card */
    .card{
      margin-top: 16px;
      border-radius: 28px;
      border: 1px solid var(--color-border-subtle);
      background: linear-gradient(180deg, #ffffff 0%, #f8fbff 100%);
      box-shadow: var(--shadow-sm);
      padding: 18px 18px 12px;
    }

    .chart-card{
      border-radius: 22px;
      border: 1px solid var(--color-border-subtle);
      background: rgba(255,255,255,0.65);
      padding: 14px 14px 10px;
      overflow: hidden;
    }

    .chart-inner{ position: relative; }
    .chart-svg{
      width: 100%;
      height: 240px;
      display: block;
    }

    .chart-footer{
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 6px 2px;
      color: var(--color-text-secondary);
      font-size: 13px;
    }

    .chart-axis-label{
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .chart-dot{
      width: 9px;
      height: 9px;
      border-radius: 999px;
      background: var(--color-point);
      display: inline-block;
    }

    /* Better chart rendering */
    .chart-grid line,
    .chart-axes line{
      stroke: rgba(100, 116, 139, 0.24);
      vector-effect: non-scaling-stroke;
      shape-rendering: crispEdges;
    }

    .chart-line{
      fill: none;
      stroke: var(--color-point);
      stroke-width: 2.25;
      vector-effect: non-scaling-stroke;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    .chart-area{
      fill: var(--color-point);
      opacity: 0.10;
    }

    .chart-point{
      fill: var(--color-surface);
      stroke: var(--color-point);
      stroke-width: 2;
      vector-effect: non-scaling-stroke;
      opacity: 0;
      transition: opacity 120ms ease;
    }

    .chart-hover .chart-point{ opacity: 1; }

    .chart-axis-text{
      font-size: 12px;
      fill: var(--color-text-secondary);
    }

    .chart-tip{
      position: absolute;
      pointer-events: none;
      padding: 8px 10px;
      border-radius: 12px;
      background: var(--color-surface);
      border: 1px solid var(--color-border-subtle);
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.12);
      color: var(--color-text-primary);
      font-size: 12px;
      white-space: nowrap;
      transform: translateZ(0);
    }

    /* Daily overview */
    .section-head{
      margin: 22px 0 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }
    .section-title{
      margin: 0;
      font-size: 18px;
    }
    .section-sub{
      margin: 2px 0 0;
      color: var(--color-text-secondary);
      font-size: 13px;
    }
    .btn{
      border: 0;
      background: var(--color-point);
      color: white;
      font-weight: 700;
      border-radius: 999px;
      padding: 10px 14px;
      cursor: pointer;
      box-shadow: 0 10px 25px rgba(37, 99, 235, 0.25);
    }

    .day{
      border-top: 1px solid var(--color-border-subtle);
      padding: 16px 2px 4px;
      display: grid;
      gap: 14px;
    }
    .day-top{
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 14px;
      flex-wrap: wrap;
    }
    .day-date{
      font-weight: 800;
    }
    .day-kcal{
      color: var(--color-text-secondary);
      font-size: 13px;
      margin-top: 2px;
    }
    .chips{
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .chip{
      border: 1px solid var(--color-border-subtle);
      background: rgba(255,255,255,0.75);
      border-radius: 999px;
      padding: 8px 10px;
      font-size: 12px;
      color: var(--color-text-secondary);
      min-width: 120px;
    }
    .chip strong{
      display: block;
      color: var(--color-text-primary);
      font-size: 13px;
      margin-top: 2px;
    }

    .foods{
      display: grid;
      gap: 8px;
      padding: 6px 0 12px;
      color: var(--color-text-secondary);
      font-size: 13px;
    }
    .foods b{ color: var(--color-text-primary); }
    .foods .item{
      display: grid;
      grid-template-columns: 1fr 90px 90px;
      gap: 10px;
      align-items: baseline;
    }
    .foods .item span:nth-child(2),
    .foods .item span:nth-child(3){
      text-align: right;
      font-variant-numeric: tabular-nums;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <h1>Calories &amp; weight</h1>
    <p class="sub">Track your body weight and daily calorie intake over time.</p>

    <div class="row">
      <div class="tabs" role="tablist" aria-label="Metric tabs">
        <button class="tab tab--active" role="tab" aria-selected="true" data-metric="weight">Weight (kg)</button>
        <button class="tab" role="tab" aria-selected="false" data-metric="calories">Calories (kcal)</button>
      </div>

      <div class="filters">
        <div class="field">
          <div><b>Date range</b></div>
          <div class="ctrl">
            <input id="fromDate" type="date" />
            <span class="dash">–</span>
            <input id="toDate" type="date" />
          </div>
        </div>

        <div class="field">
          <div><b>Sort by</b></div>
          <div class="ctrl">
            <select id="sortBy">
              <option value="recent" selected>Most recent</option>
              <option value="oldest">Oldest</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="chart-card">
        <div class="chart-inner">
          <svg id="metricChart"
               class="chart-svg"
               viewBox="0 0 640 220"
               preserveAspectRatio="xMidYMid meet"
               role="img"
               aria-label="Weight over time"></svg>

          <div id="chartTip" class="chart-tip" hidden></div>
        </div>

        <div class="chart-footer">
          <div class="chart-axis-label">
            <span class="chart-dot" aria-hidden="true"></span>
            <span id="metricLabel">Weight, kg</span>
          </div>
          <span>Date →</span>
        </div>
      </div>

      <div class="section-head">
        <div>
          <h2 class="section-title">Daily overview</h2>
          <div class="section-sub">Tap a row to view detailed products</div>
        </div>
        <button class="btn" type="button">+ Add day</button>
      </div>

      <!-- Example daily overview (static demo) -->
      <div class="day">
        <div class="day-top">
          <div>
            <div class="day-date">Aug 24, 2025</div>
            <div class="day-kcal">2 150 kcal total</div>
          </div>
          <div class="chips">
            <div class="chip">PROTEINS<strong>120 g</strong></div>
            <div class="chip">FATS<strong>70 g</strong></div>
            <div class="chip">CARBS<strong>230 g</strong></div>
            <div class="chip">WEIGHT<strong>68.2 kg</strong></div>
            <div class="chip">FAT %<strong>18.4%</strong></div>
            <div class="chip">TREND<strong>-0.3 kg</strong></div>
          </div>
        </div>

        <div class="foods">
          <div class="item"><b>Oatmeal with berries</b><span>320 g</span><span>420 kcal</span></div>
          <div class="item"><b>Chicken breast</b><span>180 g</span><span>330 kcal</span></div>
          <div class="item"><b>Rice &amp; vegetables</b><span>250 g</span><span>410 kcal</span></div>
          <div class="item"><b>Greek yogurt</b><span>150 g</span><span>130 kcal</span></div>
          <div class="item"><b>Snacks &amp; drinks</b><span>—</span><span>860 kcal</span></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ----------------------------
    // Replace this with your real data
    // date MUST be ISO (YYYY-MM-DD) for date inputs to work smoothly
    // ----------------------------
    let rawSeries = [
      { date: "2025-08-19", weight: 68.9, calories: 2100 },
      { date: "2025-08-20", weight: 68.6, calories: 1980 },
      { date: "2025-08-21", weight: 68.7, calories: 2250 },
      { date: "2025-08-22", weight: 68.8, calories: 2280 },
      { date: "2025-08-23", weight: 68.5, calories: 1930 },
      { date: "2025-08-24", weight: 68.2, calories: 2150 },
    ];

    const svg = document.getElementById("metricChart");
    const tip = document.getElementById("chartTip");
    const metricLabel = document.getElementById("metricLabel");
    const tabs = [...document.querySelectorAll(".tab")];
    const fromDate = document.getElementById("fromDate");
    const toDate = document.getElementById("toDate");
    const sortBy = document.getElementById("sortBy");

    let metric = "weight";

    function fmtShort(iso) {
      const d = new Date(iso + "T00:00:00");
      return d.toLocaleDateString(undefined, { month: "short", day: "numeric" });
    }

    function clamp(n, a, b){ return Math.min(Math.max(n, a), b); }

    function getFilteredSeries() {
      const f = fromDate.value ? new Date(fromDate.value + "T00:00:00").getTime() : -Infinity;
      const t = toDate.value ? new Date(toDate.value + "T23:59:59").getTime() : Infinity;

      let s = rawSeries
        .filter(d => {
          const ms = new Date(d.date + "T00:00:00").getTime();
          return ms >= f && ms <= t;
        })
        .slice();

      s.sort((a,b) => {
        const da = new Date(a.date).getTime();
        const db = new Date(b.date).getTime();
        return sortBy.value === "oldest" ? da - db : db - da;
      });

      // Chart should read left->right time (oldest->newest)
      // so we reverse if UI shows most recent first.
      if (sortBy.value === "recent") s.reverse();
      return s;
    }

    function renderChart() {
      const series = getFilteredSeries();

      metricLabel.textContent = metric === "weight" ? "Weight, kg" : "Calories, kcal";
      svg.setAttribute("aria-label", metric === "weight" ? "Weight over time" : "Calories over time");

      // Empty state
      if (series.length < 2) {
        svg.innerHTML = `
          <text x="50%" y="50%" text-anchor="middle" class="chart-axis-text">
            Not enough data to plot
          </text>`;
        tip.hidden = true;
        return;
      }

      // Layout (matches viewBox)
      const W = 640, H = 220;
      const padL = 56, padR = 20, padT = 16, padB = 40;
      const innerW = W - padL - padR;
      const innerH = H - padT - padB;

      // Scale
      const vals = series.map(d => d[metric]).filter(v => Number.isFinite(v));
      const min = Math.min(...vals);
      const max = Math.max(...vals);
      const span = (max - min) || 1;
      const yMin = min - span * 0.15;
      const yMax = max + span * 0.15;

      const xAt = i => padL + (innerW * (i / (series.length - 1 || 1)));
      const yAt = v => padT + (innerH * (1 - (v - yMin) / (yMax - yMin)));

      // Points
      const pts = series.map((d, i) => [xAt(i), yAt(d[metric])]);

      // Path
      const lineD = pts.map((p, i) => `${i ? "L" : "M"} ${p[0].toFixed(2)} ${p[1].toFixed(2)}`).join(" ");
      const areaD = `M ${padL} ${padT + innerH} ${lineD.replace(/^M/, "L")} L ${padL + innerW} ${padT + innerH} Z`;

      // Y ticks
      const ticks = 4;
      const yTicks = Array.from({ length: ticks + 1 }, (_, i) => {
        const v = yMin + (i * (yMax - yMin) / ticks);
        return { v, y: yAt(v) };
      });

      // X labels: first / mid / last
      const mid = Math.floor((series.length - 1) / 2);
      const xLabels = [
        { i: 0, text: fmtShort(series[0].date) },
        { i: mid, text: fmtShort(series[mid].date) },
        { i: series.length - 1, text: fmtShort(series[series.length - 1].date) },
      ];

      svg.innerHTML = `
        <g class="chart-grid">
          ${yTicks.map(t => `<line x1="${padL}" y1="${t.y}" x2="${padL + innerW}" y2="${t.y}"></line>`).join("")}
        </g>

        <g class="chart-axes">
          <line x1="${padL}" y1="${padT}" x2="${padL}" y2="${padT + innerH}"></line>
          <line x1="${padL}" y1="${padT + innerH}" x2="${padL + innerW}" y2="${padT + innerH}"></line>
        </g>

        <g class="chart-ylabels">
          ${yTicks.map(t => `
            <text class="chart-axis-text" x="${padL - 10}" y="${t.y + 4}" text-anchor="end">
              ${metric === "weight" ? t.v.toFixed(1) : Math.round(t.v)}
            </text>`).join("")}
        </g>

        <path class="chart-area" d="${areaD}"></path>
        <path class="chart-line" d="${lineD}"></path>

        <g class="chart-points">
          ${pts.map((p, i) => `
            <circle class="chart-point"
              cx="${p[0]}" cy="${p[1]}" r="5"
              data-i="${i}"></circle>
          `).join("")}
        </g>

        <g class="chart-xlabels">
          ${xLabels.map(xl => `
            <text class="chart-axis-text" x="${xAt(xl.i)}" y="${padT + innerH + 26}" text-anchor="middle">
              ${xl.text}
            </text>`).join("")}
        </g>
      `;

      // Tooltip interactions (pointer = mouse + touch + pen)
      function nearestIndex(clientX) {
        const box = svg.getBoundingClientRect();
        const relX = clientX - box.left;
        const xSvg = (relX / box.width) * W;

        let best = 0, bestDist = Infinity;
        pts.forEach((p, i) => {
          const dist = Math.abs(p[0] - xSvg);
          if (dist < bestDist) { bestDist = dist; best = i; }
        });
        return best;
      }

      function showAt(i, clientX, clientY) {
        const d = series[i];
        const v = d[metric];

        tip.hidden = false;
        tip.innerHTML =
          `<strong>${fmtShort(d.date)}</strong><br>` +
          (metric === "weight" ? `${Number(v).toFixed(1)} kg` : `${Math.round(Number(v))} kcal`);

        const box = svg.getBoundingClientRect();
        const x = clamp(clientX - box.left + 12, 12, box.width - 150);
        const y = clamp(clientY - box.top - 50, 8, box.height - 70);

        tip.style.left = `${x}px`;
        tip.style.top  = `${y}px`;
      }

      function onMove(e) {
        svg.classList.add("chart-hover");
        const i = nearestIndex(e.clientX);
        showAt(i, e.clientX, e.clientY);
      }

      function onLeave() {
        svg.classList.remove("chart-hover");
        tip.hidden = true;
      }

      svg.onpointermove = onMove;
      svg.onpointerleave = onLeave;
      svg.onpointerdown = onMove; // tap shows tooltip
    }

    function setActiveTab(nextMetric) {
      metric = nextMetric;

      tabs.forEach(btn => {
        const on = btn.dataset.metric === metric;
        btn.classList.toggle("tab--active", on);
        btn.setAttribute("aria-selected", on ? "true" : "false");
      });

      renderChart();
    }

    // Init date range inputs from data
    (function initDateRange() {
      const dates = rawSeries.map(d => d.date).sort();
      if (dates.length) {
        fromDate.value = dates[0];
        toDate.value = dates[dates.length - 1];
      }
    })();

    // Events
    tabs.forEach(btn => btn.addEventListener("click", () => setActiveTab(btn.dataset.metric)));
    fromDate.addEventListener("change", renderChart);
    toDate.addEventListener("change", renderChart);
    sortBy.addEventListener("change", renderChart);

    // Initial render
    setActiveTab("weight");
  </script>
</body>
</html>
